push    rcx              
mov     ecx, esi
push    rdi         
pushf                   
mov      al, cl             
shr     ecx, 8             
cld                         
repnz   scasb               
jz      0x400000
mov     eax, ecx           
jmp     0x4000ff
(addr 0x400000)
mov     rax, rdi
dec     rax                 

(addr 0x4000ff)
popf                        
or      rax, rax            
pop     rdi                 
pop     rcx
ret